<!doctype html>
<html lang="en-US">

    <head>
        <meta charset="utf-8">

        <title>ES6 Features</title>

        <meta name="description" content="Brief introduction of ES6 features.">
        <meta name="author" content="Gu Yiling">

        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

        <link rel="stylesheet" href="../../reveal.js/css/reveal.css">
        <link rel="stylesheet" href="../../reveal.js/css/font-awesome.css">
        <link rel="stylesheet" href="../../reveal.js/css/theme/just.css" id="theme">

        <!-- For syntax highlighting -->
        <link rel="stylesheet" href="../../reveal.js/lib/css/zenburn.css">

        <style>
            .reveal .icon-title + pre {
                margin-top: 0;
            }

            .reveal .icon-title {
                margin-bottom: 0.4em;
            }

            .reveal h3 .fa {
                font-weight: 700;
                font-size: 1em;
            }

            .reveal img.clear {
                border: none;
                background: none;
            }

            .reveal img.inline {
                vertical-align: middle;
            }
        </style>

        <!-- If the query includes "print-pdf", include the PDF print sheet -->
        <script>
            if( window.location.search.match( /print-pdf/gi ) ) {
                var link = document.createElement( "link" );
                link.rel = "stylesheet";
                link.type = "text/css";
                link.href = "../../reveal.js/css/print/pdf.css";
                document.getElementsByTagName( "head" )[0].appendChild( link );
            }
        </script>

        <!--[if lt IE 9]>
        <script src="lib/js/html5shiv.js"></script>
        <![endif]-->

        <script type="text/javascript">

          var _gaq = _gaq || [];
          _gaq.push(["_setAccount", "UA-34177998-1"]);
          _gaq.push(["_trackPageview"]);

          (function() {
            var ga = document.createElement("script"); ga.type = "text/javascript"; ga.async = true;
            ga.src = ("https:" == document.location.protocol ? "https://ssl" : "http://www") + ".google-analytics.com/ga.js";
            var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(ga, s);
          })();

        </script>
    </head>

    <body>

        <div class="reveal">

            <div class="slides">

                <section>
                    <h1>ES6 Features</h1>
                    <address>
                        <p>GU Yiling <small>@ <a href="http://efe.baidu.com/">Baidu <abbr title="Excellent Front-end">EFE</abbr></a></small></p>
                        <p>
                            <a href="http://weibo.com/justineo" title="@Justineo" class="icon-weibo"></a>
                            <a href="https://twitter.com/#!/_justineo" title="@_justineo" class="icon-twitter"></a>
                            <a href="http://github.com/Justineo" title="@Justineo" class="icon-github-circled"></a>
                        </p>
                    </address>
                </section>

                <section>
                    <h2>Status</h2>
                    <ul>
                        <li>Most features have been finalized</li>
                        <li>Many polyfills and transpilers</li>
                        <li>Some features are already supported in browsers and Node.js</li>
                        <li>May be released this year (2015)</li>
                    </ul>
                </section>

                </section>

                <section>

                    <section>
                        <h2>Arrows</h2>
                        <p>Function shorthand using <code>=></code></p>
                        <p>same lexical <code>this</code> as surrounding code</p>
                    </section>

                    <section>
                        <h3 class="icon-title"><span class="fa fa-code"></span></h3>
                        <pre><code class="js">// Expression bodies
var odds = evens.map(v => v + 1);
var nums = evens.map((v, i) => v + i);
var pairs = evens.map(v => ({even: v, odd: v + 1}));

// Statement bodies
nums.forEach(v => {
  if (v % 5 === 0)
    fives.push(v);
});

// Lexical this
var bob = {
  _name: "Bob",
  _friends: [],
  printFriends() {
    this._friends.forEach(f =>
      console.log(this._name + " knows " + f));
  }
}</code></pre>
                    </section>

                </section>

                <section>

                    <section>
                        <h2>Classes</h2>
                        <p>Simple sugar over the prototype-based OO pattern</p>
                        <ul>
                            <li>inheritance</li>
                            <li>super calls</li>
                            <li>instance</li>
                            <li>static methods</li>
                            <li>constructors</li>
                        </ul>
                    </section>

                    <section>
                        <h3 class="icon-title"><span class="fa fa-code"></span></h3>
                        <pre><code class="js">class SkinnedMesh extends THREE.Mesh {
  constructor(geometry, materials) {
    super(geometry, materials);

    this.idMatrix = SkinnedMesh.defaultMatrix();
    this.bones = [];
    this.boneMatrices = [];
    //...
  }
  update(camera) {
    //...
    super.update();
  }
  static defaultMatrix() {
    return new THREE.Matrix4();
  }
}</code></pre>
                    </section>

                </section>

                <section>

                    <section>
                        <h2>Enhanced Object Literals</h2>
                        <p>Support setting the prototype at construction</p>
                        <ul>
                            <li>shorthand for <code>foo: foo</code> assignment</li>
                            <li>defining methods</li>
                            <li>super calls</li>
                            <li>dynamic property names</li>
                        </ul>
                    </section>

                    <section>
                        <h3 class="icon-title"><span class="fa fa-code"></span></h3>
                        <pre><code class="js">var obj = {
    // __proto__
    __proto__: theProtoObj,
    // Shorthand for ‘handler: handler’
    handler,
    // Methods
    toString() {
     // Super calls
     return "d " + super.toString();
    },
    // Computed (dynamic) property names
    [ 'prop_' + (() => 42)() ]: 42
};</code></pre>
                    </section>

                </section>

                <section>

                    <section>
                        <h2>Template Strings</h2>
                        <p>Syntactic sugar for constructing strings</p>
                        <ul>
                            <li>multiline</li>
                            <li>interpolation</li>
                            <li>avoiding injection attack</li>
                        </ul>
                    </section>

                    <section>
                        <h3 class="icon-title"><span class="fa fa-code"></span></h3>
                        <pre><code class="js">// Basic literal string creation
`In JavaScript '\n' is a line-feed.`

// Multiline strings
`In JavaScript this is
 not legal.`

// String interpolation
var name = "Bob", time = "today";
`Hello ${name}, how are you ${time}?`

// Construct an HTTP request prefix is used to interpret the replacements and construction
GET`http://foo.org/bar?a=${a}&amp;b=${b}
    Content-Type: application/json
    X-Credentials: ${credentials}
    { "foo": ${foo},
      "bar": ${bar}}`(myOnReadyStateChangeHandler);</code></pre>
                    </section>

                    <section>
                        <h3 class="icon-title"><span class="fa fa-code"></span></h3>
                        <pre><code class="js">fn`Hello ${you}! You're looking ${adjective} today!`</code></pre>
                        <p>“desugars” into &darr;</p>
                        <pre><code class="js">fn(["Hello ", "! You're looking ", " today!"], you, adjective);</code></pre>
                    </section>

                </section>

                <section>

                    <section>
                        <h2>Destructuring</h2>
                        <p>Allows binding using pattern matching</p>
                        <p>(arrays &amp; objects)</p>
                    </section>

                    <section>
                        <h3 class="icon-title"><span class="fa fa-code"></span></h3>
                        <pre><code class="js" style="font-size: 70%;">// list matching
var [a, , b] = [1,2,3];

// object matching
var { op: a, lhs: { op: b }, rhs: c }
       = getASTNode()

// object matching shorthand
// binds `op`, `lhs` and `rhs` in scope
var {op, lhs, rhs} = getASTNode()

// Can be used in parameter position
function g({name: x}) {
  console.log(x);
}
g({name: 5})

// Fail-soft destructuring
var [a] = [];
a === undefined;

// Fail-soft destructuring with defaults
var [a = 1] = [];
a === 1;</code></pre>
                    </section>

                </section>

                <section>

                    <section>
                        <h2>Default + Rest + Spread</h2>
                        <ul>
                            <li>default parameter values</li>
                            <li>trailing parameters to array</li>
                            <li>array to consecutive arguments</li>
                        </ul>
                    </section>

                    <section>
                        <h3 class="icon-title"><span class="fa fa-code"></span></h3>
                        <pre><code class="js">function f(x, y=12) {
  // y is 12 if not passed (or passed as undefined)
  return x + y;
}

f(3) == 15
function f(x, ...y) {
  // y is an Array
  return x * y.length;
}

f(3, "hello", true) == 6
function f(x, y, z) {
  return x + y + z;
}
// Pass each elem of array as argument
f(...[1,2,3]) == 6</code></pre>
                    </section>

                </section>

                <section>

                    <section>
                        <h2>Let + Const</h2>
                        <p>Block-scoped binding constructs</p>
                        <ul>
                            <li><code>let</code>: <code>var</code> within block scope</li>
                            <li><code>const</code>: single assignment</li>
                        </ul>
                    </section>

                    <section>
                        <h3 class="icon-title"><span class="fa fa-code"></span></h3>
                        <pre><code class="js">function f() {
  {
    let x;
    {
      // okay, block scoped name
      const x = "sneaky";
      // error, const
      x = "foo";
    }
    // error, already declared in block
    let x = "inner";
  }
}</code></pre>
                    </section>

                </section>

                <section>

                    <section>
                        <h2>Iterators + For..Of</h2>
                        <ul>
                            <li>custom iteration<br><small><code>next()</code>, <code>value</code>, <code>done</code></small></li>
                            <li>generalize <code>for..in</code> with <code>for..of</code></li>
                        </ul>
                    </section>

                    <section>
                        <h3 class="icon-title"><span class="fa fa-code"></span></h3>
                        <pre><code class="js">let fibonacci = {
  [Symbol.iterator]() {
    let pre = 0, cur = 1;
    return {
      next() {
        [pre, cur] = [cur, pre + cur];
        return { done: false, value: cur }
      }
    }
  }
}

for (var n of fibonacci) {
  // truncate the sequence at 1000
  if (n > 1000)
    break;
  console.log(n);
}</code></pre>
                    </section>

                    <section>
                        <h3>Use cases of iterators</h3>
                        <ul>
                            <li><code>for..of</code></li>
                            <li>destructuring</li>
                            <li><code>yield *</code></li>
                            <li><code>Array.from()</code></li>
                            <li><code>Map, Set, WeakMap, WeakSet</code></li>
                            <li>...</li>
                        </ul>
                    </section>

                    <section>
                        <h3><code>for..of</code> vs. <code>for..in</code> in arrays</h3>
                        <pre><code class="js">var colors = ['red', 'green', 'blue'];

// iterate through index
for (let i in colors) {
  console.log(colors[i]);
}

// iterate through values
for (let color of colors) {
  console.log(color);
}</code></pre>
                    </section>

                </section>

                <section>

                    <section>
                        <h2>Generators</h2>
                        <p>Simplify iterator-authoring using <code>function*</code> and <code>yield</code></p>
                    </section>

                    <section>
                        <h3 class="icon-title"><span class="fa fa-code"></span></h3>
                        <pre><code class="js">var fibonacci = {
  [Symbol.iterator]: function*() {
    var pre = 0, cur = 1;
    for (;;) {
      var temp = pre;
      pre = cur;
      cur += temp;
      yield cur;
    }
  }
}

for (var n of fibonacci) {
  // truncate the sequence at 1000
  if (n > 1000)
    break;
  console.log(n);
}</code></pre>
                    </section>

                    <section>
                        <h3 class="icon-title"><span class="fa fa-link"></span></h3>
                        <ul>
                            <li><a href="https://github.com/tj/co">Co</a></li>
                            <li><a href="http://koajs.com/">Koa</a></li>
                        </ul>
                    </section>

                </section>

                <section>

                    <section>
                        <h2>Unicode</h2>
                        <p>Non-breaking additions to support full Unicode</p>
                        <ul>
                            <li>new Unicode literal form in strings</li>
                            <li>new RegExp <code>u</code> mode</li>
                            <li>new string APIs</li>
                        </ul>
                    </section>

                    <section>
                        <h3>What's wrong?</h3>
                        <p>JavaScript handles 4-bytes long characters incorrectly</p>
                        <ul>
                            <li><code>String.prototype.codePointAt()</code><br><small>to replace <code>String.prototype.charCodeAt()</code></small></li>
                            <li><code>String.fromCodePoint()</code><br><small>to replace <code>String.fromCharCode()</code></small></li>
                            <li>...</li>
                        </ul>
                    </section>

                    <section>
                        <h3 class="icon-title"><span class="fa fa-code"></span></h3>
                        <pre><code class="js">// same as ES5.1
"𠮷".length == 2

// new RegExp behaviour, opt-in ‘u’
"𠮷".match(/./u)[0].length == 2

// new form
"\u{20BB7}"=="𠮷"=="\uD842\uDFB7"

// new String ops
"𠮷".codePointAt(0) == 0x20BB7

// for-of iterates code points
for(var c of "𠮷") {
  console.log(c);
}</code></pre>
                    </section>

                </section>

                <section>

                    <section>
                        <h2>Modules</h2>
                        <p>Language-level support for modules</p>
                        <p><code>import</code> (<code>module</code>) &amp; <code>export</code></p>
                    </section>

                    <section>
                        <h3 class="icon-title"><span class="fa fa-code"></span></h3>
                        <pre><code class="js">// lib/math.js
export function sum(x, y) {
  return x + y;
}
export var pi = 3.141593;

// app.js
import * as math from "lib/math";
alert("2π = " + math.sum(math.pi, math.pi));

// otherApp.js
import {sum, pi} from "lib/math";
alert("2π = " + sum(pi, pi));</code></pre>
                    </section>

                    <section>
                        <h3 class="icon-title"><span class="fa fa-link"></span></h3>
                        <ul>
                            <li><a href="https://github.com/esnext/es6-module-transpiler">ES6 module transpiler</a></li>
                        </ul>
                    </section>

                </section>

                <section>

                    <section>
                        <h2>Module Loaders</h2>
                        <ul>
                            <li>Dynamic loading</li>
                            <li>State isolation</li>
                            <li>Global namespace isolation</li>
                            <li>Compilation hooks</li>
                            <li>Nested virtualization</li>
                        </ul>
                    </section>

                    <section>
                        <h3 class="icon-title"><span class="fa fa-code"></span></h3>
                        <pre><code class="js">// Dynamic loading – ‘System’ is default loader
System.import('lib/math').then(function(m) {
  alert("2π = " + m.sum(m.pi, m.pi));
});

// Create execution sandboxes – new Loaders
var loader = new Loader({
  global: fixup(window) // replace ‘console.log’
});
loader.eval("console.log('hello world!');");

// Directly manipulate module cache
System.get('jquery');
System.set('jquery', Module({$: $})); // WARNING: not yet finalized</code></pre>
                    </section>

                    <section>
                        <h3 class="icon-title"><span class="fa fa-link"></span></h3>
                        <ul>
                            <li><a href="https://github.com/ModuleLoader/es6-module-loader">ES6 Module Loader Polyfill</a></li>
                            <li><a href="https://github.com/systemjs/systemjs">SystemJS</a></li>
                        </ul>
                    </section>

                </section>

                <section>

                    <section>
                        <h2>Map + Set + WeakMap + WeakSet</h2>
                        <p>Efficient data structures for common algorithms</p>
                    </section>

                    <section>
                        <h3 class="icon-title"><span class="fa fa-code"></span></h3>
                        <pre><code class="js">// Sets
var s = new Set();
s.add("hello").add("goodbye").add("hello");
s.size === 2;
s.has("hello") === true;

// Maps
var m = new Map();
m.set("hello", 42);
m.set(s, 34);
m.get(s) == 34;

// Weak Maps
var wm = new WeakMap();
wm.set(s, { extra: 42 });
wm.size === undefined

// Weak Sets
var ws = new WeakSet();
ws.add({ data: 42 });
// Because the added object has no other references, it will not be held in the set</code></pre>
                    </section>

                </section>

                <section>

                    <section>
                        <h2>Proxies</h2>
                        <p>Enable creation of objects with the full range of behaviors available to host objects</p>
                        <ul>
                            <li>debugging</li>
                            <li>watching data change</li>
                        </ul>
                    </section>

                    <section>
                        <h3 class="icon-title"><span class="fa fa-code"></span></h3>
                        <pre><code class="js">// Proxying a normal object
var target = {};
var handler = {
  get: function (receiver, name) {
    return `Hello, ${name}!`;
  }
};

var p = new Proxy(target, handler);
p.world === 'Hello, world!';

// Proxying a function object
var target = function () { return 'I am the target'; };
var handler = {
  apply: function (receiver, ...args) {
    return 'I am the proxy';
  }
};

var p = new Proxy(target, handler);
p() === 'I am the proxy';</code></pre>
                    </section>

                    <section>
                        <h3 class="icon-title"><span class="fa fa-link"></span></h3>
                        <ul>
                            <li><a href="http://www.2ality.com/2014/12/es6-proxies.html">Meta programming with ECMAScript 6 proxies</a></li>
                        </ul>
                    </section>

                </section>

                <section>

                    <section>
                        <h2>Symbols</h2>
                        <p>Enable access control for object state</p>
                        <p><strong>new primitive type</strong></p>
                    </section>

                    <section>
                        <h3 class="icon-title"><span class="fa fa-code"></span></h3>
                        <pre><code class="js">var MyClass = (function() {

  // module scoped symbol
  var key = Symbol("key");

  function MyClass(privateData) {
    this[key] = privateData;
  }

  MyClass.prototype = {
    doStuff: function() {
      ... this[key] ...
    }
  };

  return MyClass;
})();

var c = new MyClass("hello")
c["key"] === undefined</code></pre>
                    </section>

                    <section>
                        <h3 class="icon-title"><span class="fa fa-link"></span></h3>
                        <ul>
                            <li><a href="http://www.2ality.com/2014/12/es6-symbols.html">Symbols in ECMAScript 6</a></li>
                        </ul>
                    </section>

                </section>

                <section>

                    <section>
                        <h2>Subclassable Built-ins</h2>
                        <p>Built-ins like <code>Array</code>, <code>Date</code> and DOM <code>Element</code>s can be subclassed</p>
                    </section>

                    <section>
                        <h3 class="icon-title"><span class="fa fa-code"></span></h3>
                        <pre><code class="js">// Pseudo-code of Array
class Array {
    constructor(...args) { /* ... */ }
    static [Symbol.create]() {
        // Install special [[DefineOwnProperty]]
        // to magically update 'length'
    }
}

// User code of Array subclass
class MyArray extends Array {
    constructor(...args) { super(...args); }
}

// Two-phase 'new':
// 1) Call @@create to allocate object
// 2) Invoke constructor on new instance
var arr = new MyArray();
arr[1] = 12;
arr.length == 2</code></pre>
                    </section>

                    <section>
                        <h3 class="icon-title"><span class="fa fa-link"></span></h3>
                        <ul>
                            <li><a href="http://www.2ality.com/2013/03/subclassing-builtins-es6.html">Subclassing builtins in ECMAScript 6</a></li>
                        </ul>
                    </section>

                </section>

                <section>

                    <section>
                        <h2>Math + Number + String + Object APIs</h2>
                        <p>Many new library additions</p>
                    </section>

                    <section>
                        <h3 class="icon-title"><span class="fa fa-code"></span></h3>
                        <pre><code class="js">Number.EPSILON
Number.isInteger(Infinity) // false
Number.isNaN("NaN") // false

Math.acosh(3) // 1.762747174039086
Math.hypot(3, 4) // 5
Math.imul(Math.pow(2, 32) - 1, Math.pow(2, 32) - 2) // 2

"abcde".includes("cd") // true
"abc".repeat(3) // "abcabcabc"

Array.from(document.querySelectorAll('*')) // Returns a real Array
Array.of(1, 2, 3) // Similar to new Array(...), but without special one-arg behavior
[0, 0, 0].fill(7, 1) // [0,7,7]
[1,2,3].findIndex(x => x == 2) // 1
["a", "b", "c"].entries() // iterator [0, "a"], [1,"b"], [2,"c"]
["a", "b", "c"].keys() // iterator 0, 1, 2
["a", "b", "c"].values() // iterator "a", "b", "c"

Object.assign(Point, { origin: new Point(0,0) })</code></pre>
                    </section>

                </section>

                <section>

                    <section>
                        <h2>Binary and Octal Literals</h2>
                        <pre><code class="js">0b111110111 === 503 // true
0o767 === 503 // true</code></pre>
                    </section>

                </section>

                <section>

                    <section>
                        <h2>Promises</h2>
                        <p>Enhancing asynchronous programming</p>
                    </section>

                    <section>
                        <h3 class="icon-title"><span class="fa fa-code"></span></h3>
                        <pre><code class="js">function timeout(duration = 0) {
    return new Promise((resolve, reject) => {
        setTimeout(resolve, duration);
    })
}

var p = timeout(1000).then(() => {
    return timeout(2000);
}).then(() => {
    throw new Error("hmm");
}).catch(err => {
    return Promise.all([timeout(100), timeout(200)]);
})</code></pre>
                    </section>

                </section>

                <section>

                    <section>
                        <h2>Reflect API</h2>
                        <p>Exposing the runtime-level meta-operations on objects</p>
                    </section>

                    <section>
                        <h3 class="icon-title"><span class="fa fa-link"></span></h3>
                        <ul>
                            <li><a href="http://stackoverflow.com/questions/25421903/what-does-the-reflect-object-do-in-javascript">What does the Reflect object do in JavaScript?</a></li>
                        </ul>
                    </section>

                </section>

                <section>

                    <section>
                        <h2>Tail Calls</h2>
                        <p>Makes recursive algorithms safe in the face of unbounded inputs</p>
                    </section>

                    <section>
                        <h3 class="icon-title"><span class="fa fa-code"></span></h3>
                        <pre><code class="js">function factorial(n, acc = 1) {
    'use strict';
    if (n <= 1) return acc;
    return factorial(n - 1, n * acc);
}

// Stack overflow in most implementations today,
// but safe on arbitrary inputs in ES6
factorial(100000)</code></pre>
                    </section>

                </section>

                <section>
                    <h3>References</h3>
                    <ul>
                        <li><a href="http://wiki.ecmascript.org/doku.php?id=harmony:specification_drafts">Draft Specification for ES.next (Ecma-262 Edition 6)</a></li>
                        <li><a href="https://people.mozilla.org/~jorendorff/es6-draft.html">ECMAScript Language Specification ECMA-262 6th Edition &ndash; DRAFT</a></li>
                        <li><a href="http://git.io/es6features">Overview of ECMAScript 6 features</a></li>
                        <li><a href="http://es6.ruanyifeng.com/">ECMAScript 6 Primer</a> <small>(Simplified Chinese)</small></li>
                        <li><a href="http://kangax.github.io/compat-table/es6/">ECMAScript 6 compatibility table</a></li>
                        <li><a href="https://babeljs.io/">Babel · The transpiler for writing next generation JavaScript</a></li>
                    </ul>
                </section>

                <section>
                    <h1>Q ? A : Thanks</h1>
                </section>
            </div>

        </div>

        <script src="../../reveal.js/lib/js/head.min.js"></script>
        <script src="../../reveal.js/js/reveal.min.js"></script>

        <script>

            // Full list of configuration options available here:
            // https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                controls: true,
                progress: true,
                history: true,
                center: true,

                theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
                transition: Reveal.getQueryHash().transition || "linear", // default/cube/page/concave/zoom/linear/fade/none

                // Parallax scrolling
                // parallaxBackgroundImage: "https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg",
                // parallaxBackgroundSize: "2100px 900px",

                // Optional libraries used to extend on reveal.js
                dependencies: [
                    { src: "../../reveal.js/lib/js/classList.js", condition: function() { return !document.body.classList; } },
                    { src: "../../reveal.js/plugin/hyphenator/h.js", condition: function() { return !!document.querySelector( ".hyphenate" ); } },
                    { src: "../../reveal.js/plugin/markdown/marked.js", condition: function() { return !!document.querySelector( "[data-markdown]" ); } },
                    { src: "../../reveal.js/plugin/markdown/markdown.js", condition: function() { return !!document.querySelector( "[data-markdown]" ); } },
                    { src: "../../reveal.js/plugin/highlight/highlight.js", async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
                    { src: "../../reveal.js/plugin/zoom-js/zoom.js", async: true, condition: function() { return !!document.body.classList; } },
                    { src: "../../reveal.js/plugin/notes/notes.js", async: true, condition: function() { return !!document.body.classList; } }
                ]
            });

        </script>
    </body>
</html>
